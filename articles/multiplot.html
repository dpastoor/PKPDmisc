<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multiplots • PKPDmisc</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- docsearch --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Multiplots">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PKPDmisc</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">2.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/multiplot.html">Multiplots</a>
    </li>
    <li>
      <a href="../articles/noncompartmental-analysis.html">Noncompartmental Analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dpastoor/PKPDmisc">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Multiplots</h1>
                        <h4 class="author">Devin Pastoor</h4>
            
            <h4 class="date">2018-05-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/dpastoor/PKPDmisc/blob/master/vignettes/multiplot.Rmd"><code>vignettes/multiplot.Rmd</code></a></small>
      <div class="hidden name"><code>multiplot.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(PKPDmisc) <span class="co"># for binning and other functions</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(ggplot2) <span class="co">#plotting</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(purrr) <span class="co"># dataset to handle lists</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">suppressMessages</span>(<span class="kw">suppressWarnings</span>(<span class="kw">library</span>(dplyr)))</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">dat &lt;-<span class="st"> </span>sd_oral_richpk <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(ID <span class="op">&lt;=</span><span class="st"> </span><span class="dv">20</span>)</a></code></pre></div>
<p>Messy plot can’t see individuals well</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(dat, <span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> Conc, <span class="dt">group=</span> ID)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/facet_wrap">facet_wrap</a></span>(<span class="op">~</span>ID, <span class="dt">scales=</span> <span class="st">"free"</span>)</a></code></pre></div>
<p><img src="multiplot_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>What we’d like to be able to do is split up into ‘bins’ of specified numbers of individuals to then plot out multiple plots</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># this will automatically create a column of bins such that the</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co"># specified number of individuals is in each bin, in this case</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co"># 9 ids per bin</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co"># split the original dataset into subdatasets corresponding to each bin (list of dataframes)</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">split_dat &lt;-<span class="st"> </span>dat <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">PLOTS =</span> <span class="kw"><a href="../reference/chunk.html">ids_per_plot</a></span>(ID, <span class="dv">4</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># default is 9 per subplot</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="st">  </span><span class="kw">split</span>(.[[<span class="st">"PLOTS"</span>]])</a></code></pre></div>
<p>To handle plotting each subdataframe, you need to wrap your normal ggplot into a function. You will then apply this function with <code>map</code> to each subdataframe. So in this case it is just like a normal plot, but wrapped up in a function, which takes 1 argument (the dataframe) and outputs the plot</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">p_conc_time &lt;-<span class="st"> </span><span class="cf">function</span>(df) {</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(df, <span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> Conc, <span class="dt">group=</span> ID)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/facet_wrap">facet_wrap</a></span>(<span class="op">~</span>ID, <span class="dt">scales=</span> <span class="st">"free"</span>)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">}</a></code></pre></div>
<p>To apply the above function we use <code>map</code> from <code>purrr</code></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">split_dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/purrr/topics/map">map</a></span>(p_conc_time) </a></code></pre></div>
<pre><code>## $`1`</code></pre>
<p><img src="multiplot_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<pre><code>## 
## $`2`</code></pre>
<p><img src="multiplot_files/figure-html/unnamed-chunk-6-2.png" width="700"></p>
<pre><code>## 
## $`3`</code></pre>
<p><img src="multiplot_files/figure-html/unnamed-chunk-6-3.png" width="700"></p>
<pre><code>## 
## $`4`</code></pre>
<p><img src="multiplot_files/figure-html/unnamed-chunk-6-4.png" width="700"></p>
<pre><code>## 
## $`5`</code></pre>
<p><img src="multiplot_files/figure-html/unnamed-chunk-6-5.png" width="700"></p>
<p>As you can notice from the vignette, there is still a code-based output separating each subplot, which is not ideal for reporting. As such, there is a special function <code>print_plots</code> in PKPDmisc that will clean up the output slightly. It also automatically restarts the page numbering if knitting to PDF to page 1, making it each to extract only the pages related to plots to embed cleanly in other reports.</p>
<p>To use <code>print_plots</code> we want to save the ggplot output (rather than let it be printed directly) and give that to print plots.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">plot_list &lt;-<span class="st"> </span>split_dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/purrr/topics/map">map</a></span>(p_conc_time) </a></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="../reference/print_plots.html">print_plots</a></span>(plot_list)</a></code></pre></div>
<p><img src="multiplot_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p><img src="multiplot_files/figure-html/unnamed-chunk-8-2.png" width="700"></p>
<p><img src="multiplot_files/figure-html/unnamed-chunk-8-3.png" width="700"></p>
<p><img src="multiplot_files/figure-html/unnamed-chunk-8-4.png" width="700"></p>
<p><img src="multiplot_files/figure-html/unnamed-chunk-8-5.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/session_info">session_info</a></span>()</a></code></pre></div>
<pre><code>## Session info -------------------------------------------------------------</code></pre>
<pre><code>##  setting  value                       
##  version  R version 3.4.3 (2017-11-30)
##  system   x86_64, darwin17.4.0        
##  ui       unknown                     
##  language (EN)                        
##  collate  en_US.UTF-8                 
##  tz       America/New_York            
##  date     2018-05-15</code></pre>
<pre><code>## Packages -----------------------------------------------------------------</code></pre>
<pre><code>##  package    * version    date       source                             
##  assertthat   0.2.0      2017-04-11 CRAN (R 3.4.2)                     
##  backports    1.1.2      2017-12-13 CRAN (R 3.4.2)                     
##  base       * 3.4.3      2018-03-12 local                              
##  bindr        0.1.1      2018-03-13 CRAN (R 3.4.3)                     
##  bindrcpp   * 0.2.2      2018-03-29 CRAN (R 3.4.3)                     
##  colorspace   1.3-2      2016-12-14 CRAN (R 3.4.2)                     
##  commonmark   1.4        2017-09-01 CRAN (R 3.4.2)                     
##  compiler     3.4.3      2018-03-12 local                              
##  crayon       1.3.4      2017-09-16 CRAN (R 3.4.2)                     
##  datasets   * 3.4.3      2018-03-12 local                              
##  desc         1.1.1.9002 2018-02-12 Github (r-lib/desc@9db1377)        
##  devtools     1.13.3     2017-08-02 CRAN (R 3.4.2)                     
##  digest       0.6.15     2018-01-28 CRAN (R 3.4.2)                     
##  dplyr      * 0.7.4      2017-09-28 CRAN (R 3.4.2)                     
##  evaluate     0.10.1     2017-06-24 CRAN (R 3.4.2)                     
##  fs           1.2.2      2018-03-21 CRAN (R 3.4.3)                     
##  ggplot2    * 2.2.1      2016-12-30 CRAN (R 3.4.2)                     
##  glue         1.2.0.9000 2018-03-01 Github (tidyverse/glue@9d96cbf)    
##  graphics   * 3.4.3      2018-03-12 local                              
##  grDevices  * 3.4.3      2018-03-12 local                              
##  grid         3.4.3      2018-03-12 local                              
##  gtable       0.2.0      2016-02-26 CRAN (R 3.4.2)                     
##  htmltools    0.3.6      2017-04-28 CRAN (R 3.4.2)                     
##  knitr        1.20       2018-02-20 CRAN (R 3.4.2)                     
##  labeling     0.3        2014-08-23 CRAN (R 3.4.2)                     
##  lazyeval     0.2.1      2017-10-29 cran (@0.2.1)                      
##  magrittr     1.5        2014-11-22 CRAN (R 3.4.2)                     
##  MASS         7.3-47     2017-02-26 CRAN (R 3.4.3)                     
##  memoise      1.1.0      2017-10-20 Github (hadley/memoise@d63ae9c)    
##  methods    * 3.4.3      2018-03-12 local                              
##  munsell      0.4.3      2016-02-13 CRAN (R 3.4.2)                     
##  pillar       1.2.2      2018-04-26 CRAN (R 3.4.3)                     
##  pkgconfig    2.0.1      2017-03-21 CRAN (R 3.4.2)                     
##  pkgdown      1.0.0      2018-05-03 CRAN (R 3.4.3)                     
##  PKPDmisc   * 2.1.1      2017-12-17 CRAN (R 3.4.3)                     
##  plyr         1.8.4      2016-06-08 CRAN (R 3.4.2)                     
##  purrr      * 0.2.4      2017-10-18 CRAN (R 3.4.2)                     
##  R6           2.2.2      2017-06-17 CRAN (R 3.4.2)                     
##  Rcpp         0.12.16    2018-03-13 CRAN (R 3.4.3)                     
##  rlang        0.2.0      2018-02-20 CRAN (R 3.4.3)                     
##  rmarkdown    1.9        2018-03-01 CRAN (R 3.4.3)                     
##  roxygen2     6.0.1.9000 2018-03-01 Github (klutometis/roxygen@be3ef30)
##  rprojroot    1.3-2      2018-01-03 CRAN (R 3.4.2)                     
##  rstudioapi   0.7        2017-09-07 CRAN (R 3.4.2)                     
##  scales       0.5.0      2017-08-24 CRAN (R 3.4.2)                     
##  stats      * 3.4.3      2018-03-12 local                              
##  stringi      1.2.2      2018-05-02 CRAN (R 3.4.3)                     
##  stringr      1.3.0      2018-02-19 CRAN (R 3.4.2)                     
##  tibble       1.4.2      2018-01-22 CRAN (R 3.4.2)                     
##  tools        3.4.3      2018-03-12 local                              
##  utils      * 3.4.3      2018-03-12 local                              
##  withr        2.1.2      2018-03-15 CRAN (R 3.4.3)                     
##  xml2         1.2.0      2018-01-24 CRAN (R 3.4.2)                     
##  yaml         2.1.16     2017-12-12 CRAN (R 3.4.2)</code></pre>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Devin Pastoor.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script><script>
  docsearch({
    
    
    apiKey: '6417058f1efec10fab175718f9ee85d7',
    indexName: 'pkpdmisc',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
